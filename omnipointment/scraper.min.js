function download(e,t){var r=document.createElement("a");r.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(t)),r.setAttribute("download",e),r.style.display="none",document.body.appendChild(r),r.click(),document.body.removeChild(r)}function getDateTime(e){var t=new Date(1e3*e);return t.setUTCHours(t.getUTCHours()+6),t}function scrapeCellTime(e){var t=e.id,r=parseInt(t.replace("GroupTime",""),10);return getDateTime(r)}for(var MEETING_DATA={mid:null,creator:"Created on When2Meet",name:null,message:null,users:[],timeOptions:[],responders:[]},GLOBAL={DAY:864e5,MINUTE:6e4},allDivs=document.getElementsByTagName("div"),timeDivs=[],d=0;d<allDivs.length;d++)allDivs[d].id.indexOf("GroupTime")>-1&&timeDivs.push(allDivs[d]);for(var start=scrapeCellTime(timeDivs[0]),end=scrapeCellTime(timeDivs[timeDivs.length-1]),datesList=[],currentTime=start.getTime();currentTime<=end.getTime();)datesList.push(currentTime),currentTime+=GLOBAL.DAY;var endDay=new Date(start.getTime());endDay.setHours(end.getHours()),endDay.setMinutes(end.getMinutes());var duration=(endDay.getTime()-start.getTime())/GLOBAL.MINUTE,priority=!1,option={dates:datesList,duration:duration,isPriority:priority,startHours:start.getHours(),startMinutes:start.getMinutes()};MEETING_DATA.timeOptions.push(option);var nameDiv=document.getElementById("NewEventNameDiv"),dirty=nameDiv.innerText,clean=dirty.substr(0,dirty.indexOf("\n"));MEETING_DATA.name=clean;var midFromName=clean.replace(/ /g,"-").toLowerCase();MEETING_DATA.mid=midFromName,MEETING_DATA.message="Converted from When2Meet with love by Omnipointment.",MEETING_DATA.users=PeopleIDs;for(var respondersById={},k=0;k<PeopleIDs.length;k++)respondersById[PeopleIDs[k]]=[];for(var t=0;t<TimeOfSlot.length;t++)for(var time=getDateTime(TimeOfSlot[t]),duration=15,free=2,a=0;a<AvailableAtSlot[t].length;a++){var userID=AvailableAtSlot[t][a],slotID=userID+"-"+time,timeslot={_id:slotID,duration:duration,time:time,userId:userID,free:free};respondersById[userID].push(timeslot)}var responders=[];for(id in respondersById){var name=PeopleNames[PeopleIDs.indexOf(parseInt(id,10))];responders.push({name:name,providerId:id,providerType:"when2meet",email:"[Email for: "+name+"]",timeslots:respondersById[id]})}MEETING_DATA.responders=responders;var stringified=JSON.stringify(MEETING_DATA);console.warn("OUTPUT: JSON Meeting Object for Omnipointment:"),console.log(MEETING_DATA),console.warn("The JSON data is being downloaded to your computer."),download(MEETING_DATA.mid+".txt",stringified);